var Dom=YAHOO.util.Dom;var Event=YAHOO.util.Event;var valid=false;var currentId;var currentType;var action=0;var popMenu=function(){Dom.setStyle("charts_menu","visibility","visible");Dom.setStyle("bar","visibility","hidden")};var hideMenu=function(){if(!valid){Dom.setStyle("charts_menu","visibility","hidden");Dom.setStyle("bar","visibility","visible")}};var fadeMenu=function(){setTimeout(hideMenu,500)};var showError=function(e){Dom.setStyle("errorPan","display","block");Dom.get("error_content").innerHTML=e};var showChartList=function(a){var b=Dom.getStyle("charts_"+a,"display");if(b=="none"){Dom.setStyle("charts_"+a,"display","block")}if(b=="block"){Dom.setStyle("charts_"+a,"display","none")}};var setChart=function(a,b,c){Dom.setStyle("charts_menu","visibility","hidden");Dom.setStyle("bar","visibility","visible");Dom.get("timeRange").innerHTML="";currentId=a;currentType=b;Dom.get("current").innerHTML=c;var d="id="+currentId;var e=function(o){Dom.get("timeRange").innerHTML=o.responseText};var f={success:e};var g=YAHOO.util.Connect.asyncRequest('POST','getTimeRange.php',f,d)};var showChart=function(){Dom.setStyle("errorPan","display","none");if(currentId==undefined){showError("您没有选择Chart。");return}var a=Dom.get("minDate").innerHTML+" "+Dom.get("minTime").value;var b=Dom.get("maxDate").innerHTML+" "+Dom.get("maxTime").value;if(a==b){showError("您选择的时间没有间隔。");return}var c="id="+currentId+"&type="+currentType;c=c+"&minTime="+a;c=c+"&maxTime="+b;c=c+"&chartName="+(Dom.get("current").innerHTML);var d=function(o){var r=o.responseText;if(r==1){if(action==1){action=0;Dom.get("getSourceForm").action="getSource.php";Dom.get("getSourceForm").submit()}else if(action==2){action=0;Dom.get("getSourceForm").action="getProperty.php";Dom.get("getSourceForm").submit()}else{FlashManager.update()}}else{showError(r)}};var e={success:d};var f=YAHOO.util.Connect.asyncRequest('POST','setChart.php',e,c)};var showSource=function(){action=1;showChart()};var showProperty=function(){action=2;showChart()};Event.onDOMReady(function(){Event.addListener(["current","arrow"],"mouseover",popMenu);Event.addListener(["current","arrow"],"mouseout",fadeMenu);Event.addListener(["current","arrow"],"mousemove",popMenu);Event.addListener("charts_menu","mouseover",function(){valid=true});Event.addListener("charts_menu","mouseout",function(){valid=false;fadeMenu()});Event.addListener("showBt","click",showChart);Event.addListener("sourceBt","click",showSource);Event.addListener("propertyBt","click",showProperty);FlashManager.setFlash("FreeSPC",1000,545,document.getElementById('chart_container'))});var lastWeek=new Date();var tomorow=new Date();lastWeek.setDate(lastWeek.getDate()-6);tomorow.setDate(tomorow.getDate()+1);var minDateInit=lastWeek.getFullYear()+"/"+(lastWeek.getMonth()+1)+"/"+lastWeek.getDate();var maxDateInit=tomorow.getFullYear()+"/"+(tomorow.getMonth()+1)+"/"+tomorow.getDate();var minTimeInit=maxTimeInit="0:00";